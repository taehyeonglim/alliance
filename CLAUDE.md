# CLAUDE.md - Project Alliance ê°œë°œ ê°€ì´ë“œ

ì´ ë¬¸ì„œëŠ” Claude Codeê°€ Project Alliance ê°œë°œì„ ì§€ì›í•  ë•Œ ì°¸ê³ í•´ì•¼ í•  í•µì‹¬ ì •ë³´ì…ë‹ˆë‹¤.

## í”„ë¡œì íŠ¸ ê°œìš”

**Project Alliance**ëŠ” ì—°êµ¬ìë¥¼ ìœ„í•œ AI ê³µë™ì—°êµ¬ì(AI Co-scientist) ë©€í‹° ì—ì´ì „íŠ¸ ì‹œìŠ¤í…œì…ë‹ˆë‹¤.
- ì—°êµ¬ì˜ ì „ì²´ ì‚¬ì´í´ ê´€ì¥: ì•„ì´ë””ì–´ â†’ ë¬¸í—Œê²€ìƒ‰ â†’ ì‹¤í—˜ì„¤ê³„ â†’ ë¶„ì„ â†’ ë…¼ë¬¸ â†’ ì¶œíŒ
- Human-in-the-Loop: ì£¼ìš” ë‹¨ê³„ì—ì„œ ì—°êµ¬ì ìŠ¹ì¸ í•„ìš”
- í™•ì¥ ê°€ëŠ¥í•œ êµ¬ì¡°: ì—ì´ì „íŠ¸/ì›Œí¬í”Œë¡œìš° ì¶”ê°€ ìš©ì´
- Google ADK í˜¸í™˜ ì„¤ê³„

## ë¹Œë“œ ë° ì‹¤í–‰

```bash
npm install          # ì˜ì¡´ì„± ì„¤ì¹˜
npm run build        # TypeScript ì»´íŒŒì¼
npm run typecheck    # íƒ€ì… ì²´í¬ë§Œ
npm run dev          # ê°œë°œ ëª¨ë“œ (tsx watch)
npm run test         # í…ŒìŠ¤íŠ¸ ì‹¤í–‰
```

## í•µì‹¬ ë””ë ‰í† ë¦¬ êµ¬ì¡°

```
src/
â”œâ”€â”€ index.ts                    # Alliance ë©”ì¸ í´ë˜ìŠ¤, ëª¨ë“  export
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ interfaces/             # í•µì‹¬ ì¸í„°í˜ì´ìŠ¤ (IAgent, IWorkflow, etc.)
â”‚   â”œâ”€â”€ types/                  # íƒ€ì… ì •ì˜ (AgentContext, StateKeys, etc.)
â”‚   â””â”€â”€ base/BaseAgent.ts       # ëª¨ë“  ì—ì´ì „íŠ¸ì˜ ì¶”ìƒ ë² ì´ìŠ¤
â”œâ”€â”€ agents/
â”‚   â”œâ”€â”€ registry/               # AgentRegistry
â”‚   â””â”€â”€ research/               # 6ê°œ ì—°êµ¬ ì—ì´ì „íŠ¸ (í˜„ì¬ ìŠ¤ì¼ˆë ˆí†¤)
â”œâ”€â”€ orchestration/
â”‚   â”œâ”€â”€ WorkflowEngine.ts       # ì›Œí¬í”Œë¡œìš° ì‹¤í–‰ ì—”ì§„
â”‚   â””â”€â”€ workflows/              # Sequential, Parallel, Loop
â”œâ”€â”€ state/StateManager.ts       # ì„¸ì…˜ ìƒíƒœ ê´€ë¦¬
â”œâ”€â”€ human-in-loop/              # HITL (InterventionManager, ApprovalGate)
â”œâ”€â”€ config/ConfigLoader.ts      # YAML ì„¤ì • ë¡œë”
â””â”€â”€ utils/logger.ts             # ë¡œê¹…

config/
â”œâ”€â”€ agents/*.yaml               # ì—ì´ì „íŠ¸ ì„¤ì • (skills ì •ì˜ ìœ„ì¹˜)
â””â”€â”€ workflows/*.yaml            # ì›Œí¬í”Œë¡œìš° ì„¤ì •
```

## 6ê°œ ì—°êµ¬ ì—ì´ì „íŠ¸

| ID | í•œêµ­ì–´ | outputKey | ìŠ¹ì¸ í•„ìš” |
|----|--------|-----------|----------|
| `idea-building` | ì•„ì´ë””ì–´ ë¹Œë”© | `research_idea` | No |
| `literature-search` | ë¬¸í—Œê²€ìƒ‰ | `literature_results` | No |
| `experiment-design` | ì‹¤í—˜ì„¤ê³„ | `experiment_design` | **Yes** |
| `data-analysis` | ë°ì´í„°ë¶„ì„ | `analysis_results` | No |
| `paper-writing` | ë…¼ë¬¸ì“°ê¸° | `paper_draft` | **Yes** |
| `formatting-review` | í¬ë§·íŒ… ê²€í†  | `final_document` | **Yes** |

## í•µì‹¬ íŒ¨í„´

### ì—ì´ì „íŠ¸ ê°„ ë°ì´í„° ì „ë‹¬
```typescript
// ì—ì´ì „íŠ¸ê°€ ê²°ê³¼ ì €ì¥
if (this.outputKey) {
  context.state.set(this.outputKey, output);
}

// ë‹¤ìŒ ì—ì´ì „íŠ¸ê°€ ì°¸ì¡° (instruction í…œí”Œë¦¿)
instruction: "Review: {research_idea}"
```

### ìƒˆ ì—ì´ì „íŠ¸ ì¶”ê°€ ì‹œ
1. `src/agents/research/NewAgent.ts` ìƒì„± (BaseAgent ìƒì†)
2. `config/agents/new-agent.yaml` ì„¤ì • ì¶”ê°€
3. `src/agents/research/index.ts` export ì¶”ê°€
4. `src/index.ts` factories ë“±ë¡

### Skills ì •ì˜ (YAML)
```yaml
skills:
  - name: skill_name
    description: What it does
    enabled: true
    config:
      option: value
```

## ì£¼ìš” ì¸í„°í˜ì´ìŠ¤

### IAgent
```typescript
interface IAgent {
  id: string;
  name: string;
  displayName: { en: string; ko: string };
  description: string;
  instruction: string;
  tools: Tool[];
  skills: Skill[];
  outputKey?: string;
  execute(context: AgentContext): Promise<AgentResult>;
}
```

### AgentContext
```typescript
interface AgentContext {
  state: ISessionState;        // ê³µìœ  ìƒíƒœ
  invocation: InvocationContext;
  signal: AbortSignal;
  logger: ILogger;
  hitl: HITLInterface;
}
```

### WorkflowDefinition
```typescript
interface WorkflowDefinition {
  id: string;
  name: string;
  type: 'sequential' | 'parallel' | 'loop' | 'hybrid';
  agents: Array<{ id: string } | { workflow: WorkflowDefinition }>;
  config?: {
    maxIterations?: number;
    continueOnError?: boolean;
    approvalGates?: string[];
  };
}
```

## ì½”ë“œ ìŠ¤íƒ€ì¼

- TypeScript strict mode
- ESM (import/export with .js extensions)
- Zod for schema validation
- í•œêµ­ì–´/ì˜ì–´ ì´ì¤‘ í‘œê¸° (displayName)

## ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨

### ì‹œìŠ¤í…œ ì „ì²´ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Alliance                                 â”‚
â”‚                    (Main Entry Point)                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ConfigLoader â”‚  â”‚ StateManager â”‚  â”‚ InterventionManager  â”‚  â”‚
â”‚  â”‚   (YAML)     â”‚  â”‚  (Session)   â”‚  â”‚      (HITL)          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â”‚                 â”‚                      â”‚               â”‚
â”‚         â–¼                 â–¼                      â–¼               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                   WorkflowEngine                         â”‚   â”‚
â”‚  â”‚         (Orchestration & Execution)                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                            â”‚                                    â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚         â–¼                  â–¼                  â–¼                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ Sequential â”‚    â”‚  Parallel  â”‚    â”‚    Loop    â”‚           â”‚
â”‚  â”‚  Workflow  â”‚    â”‚  Workflow  â”‚    â”‚  Workflow  â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚        â”‚                 â”‚                  â”‚                   â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                          â–¼                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                   AgentRegistry                          â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚   â”‚
â”‚  â”‚  â”‚  Idea   â”‚ â”‚  Lit.   â”‚ â”‚  Exp.   â”‚ â”‚  Data   â”‚  ...  â”‚   â”‚
â”‚  â”‚  â”‚Building â”‚ â”‚ Search  â”‚ â”‚ Design  â”‚ â”‚Analysis â”‚       â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ì—°êµ¬ ì›Œí¬í”Œë¡œìš° ì‹¤í–‰ íë¦„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Default Research Workflow                          â”‚
â”‚                      (Sequential + HITL)                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Idea        â”‚â”€â”€â”€â–¶â”‚ 2. Literature  â”‚â”€â”€â”€â–¶â”‚ 3. Experiment  â”‚
â”‚    Building    â”‚    â”‚    Search      â”‚    â”‚    Design      â”‚
â”‚                â”‚    â”‚                â”‚    â”‚                â”‚
â”‚ Output:        â”‚    â”‚ Output:        â”‚    â”‚ Output:        â”‚
â”‚ research_idea  â”‚    â”‚ literature_    â”‚    â”‚ experiment_    â”‚
â”‚                â”‚    â”‚ results        â”‚    â”‚ design         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                     â”‚
                                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
                                            â”‚  ğŸ›‘ HITL Gate   â”‚
                                            â”‚  Approval #1    â”‚
                                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                     â”‚
                                                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. Formatting  â”‚â—€â”€â”€â”€â”‚ 5. Paper       â”‚â—€â”€â”€â”€â”‚ 4. Data        â”‚
â”‚    Review      â”‚    â”‚    Writing     â”‚    â”‚    Analysis    â”‚
â”‚                â”‚    â”‚                â”‚    â”‚                â”‚
â”‚ Output:        â”‚    â”‚ Output:        â”‚    â”‚ Output:        â”‚
â”‚ final_document â”‚    â”‚ paper_draft    â”‚    â”‚ analysis_      â”‚
â”‚                â”‚    â”‚                â”‚    â”‚ results        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ›‘ HITL Gate  â”‚    â”‚  ğŸ›‘ HITL Gate  â”‚
â”‚  Approval #3   â”‚    â”‚  Approval #2   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
   âœ… Complete
```

### ì—ì´ì „íŠ¸ ìƒíƒœ ê³µìœ  ë©”ì»¤ë‹ˆì¦˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SessionState                              â”‚
â”‚                 (Shared State Store)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚   research_idea: "..."      â—€â”€â”€ IdeaBuildingAgent           â”‚
â”‚   literature_results: {...} â—€â”€â”€ LiteratureSearchAgent       â”‚
â”‚   experiment_design: {...}  â—€â”€â”€ ExperimentDesignAgent       â”‚
â”‚   analysis_results: {...}   â—€â”€â”€ DataAnalysisAgent           â”‚
â”‚   paper_draft: "..."        â—€â”€â”€ PaperWritingAgent           â”‚
â”‚   final_document: "..."     â—€â”€â”€ FormattingReviewAgent       â”‚
â”‚                                                              â”‚
â”‚   temp:* (current turn only)                                 â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ state.get('research_idea')
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Agent Instruction                         â”‚
â”‚   "Based on the research idea: {research_idea},             â”‚
â”‚    search for relevant literature..."                        â”‚
â”‚                         â†“                                    â”‚
â”‚   Template interpolation replaces {key} with state values   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ íŒ¨í„´

```
Sequential                    Parallel                      Loop
â”â”â”â”â”â”â”â”â”â”                    â”â”â”â”â”â”â”â”                      â”â”â”â”

â”Œâ”€â”€â”€â”                        â”Œâ”€â”€â”€â”                         â”Œâ”€â”€â”€â”
â”‚ A â”‚                        â”‚ A â”‚                         â”‚ A â”‚â—€â”€â”
â””â”€â”¬â”€â”˜                        â””â”€â”¬â”€â”˜                         â””â”€â”¬â”€â”˜  â”‚
  â”‚                       â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”                        â”‚    â”‚
  â–¼                       â–¼         â–¼                        â–¼    â”‚
â”Œâ”€â”€â”€â”                   â”Œâ”€â”€â”€â”     â”Œâ”€â”€â”€â”                   â”Œâ”€â”€â”€â”€â”€â” â”‚
â”‚ B â”‚                   â”‚ B â”‚     â”‚ C â”‚                   â”‚Checkâ”‚ â”‚
â””â”€â”¬â”€â”˜                   â””â”€â”¬â”€â”˜     â””â”€â”¬â”€â”˜                   â””â”€â”€â”¬â”€â”€â”˜ â”‚
  â”‚                       â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                        â”‚    â”‚
  â–¼                            â–¼                         No  â”‚    â”‚
â”Œâ”€â”€â”€â”                       â”Œâ”€â”€â”€â”€â”€â”                      â”Œâ”€â”€â”€â–¼â”€â”€â”€â”â”‚
â”‚ C â”‚                       â”‚Mergeâ”‚                      â”‚ Done? â”œâ”˜
â””â”€â”€â”€â”˜                       â””â”€â”€â”€â”€â”€â”˜                      â””â”€â”€â”€â”¬â”€â”€â”€â”˜
                                                          Yesâ”‚
                                                             â–¼
                                                           Done

Hybrid: Sequential + Parallel ì¡°í•©
â”â”â”â”â”â”

â”Œâ”€â”€â”€â”
â”‚ A â”‚ (Sequential)
â””â”€â”¬â”€â”˜
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Parallel Block â”‚
â”‚  â”Œâ”€â”€â”€â”   â”Œâ”€â”€â”€â”  â”‚
â”‚  â”‚ B â”‚   â”‚ C â”‚  â”‚
â”‚  â””â”€â”€â”€â”˜   â””â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–¼
      â”Œâ”€â”€â”€â”€â”€â”
      â”‚Mergeâ”‚
      â””â”€â”€â”¬â”€â”€â”˜
         â–¼
       â”Œâ”€â”€â”€â”
       â”‚ D â”‚ (Sequential)
       â””â”€â”€â”€â”˜
```

### Human-in-the-Loop ìƒì„¸ í”Œë¡œìš°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Agent Execution Complete                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Is this agent   â”‚
                    â”‚ in approvalGatesâ”‚
                    â”‚ config?         â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ No                          â”‚ Yes
              â–¼                             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Continue to     â”‚          â”‚ InterventionManager â”‚
    â”‚ next agent      â”‚          â”‚ requestApproval()   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                            â”‚
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â–¼                           â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ ConsoleHandler  â”‚   or   â”‚ Custom Handler  â”‚
                    â”‚ (CLI prompt)    â”‚        â”‚ (Web UI, etc.)  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚                          â”‚
                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                           â–¼
                                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                â”‚ HumanResponse   â”‚
                                â”‚ - approved      â”‚
                                â”‚ - feedback      â”‚
                                â”‚ - modifications â”‚
                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Approved                               â”‚ Rejected
                    â–¼                                        â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚ Apply feedback  â”‚                    â”‚ escalate = true     â”‚
          â”‚ Continue flow   â”‚                    â”‚ Stop workflow       â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## í˜„ì¬ ìƒíƒœ

### Core Engine (src/)
- **ì™„ë£Œ**: í”„ë¡œì íŠ¸ êµ¬ì¡°, ì¸í„°í˜ì´ìŠ¤, ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜, HITL, ì„¤ì • ì‹œìŠ¤í…œ
- **ìŠ¤ì¼ˆë ˆí†¤**: 6ê°œ ì—°êµ¬ ì—ì´ì „íŠ¸ (skills ë¯¸ì •ì˜, ì‹¤ì œ ë¡œì§ ë¯¸êµ¬í˜„)
- **ì˜ˆì •**: LLM ì—°ë™, Tools êµ¬í˜„, ì‹¤ì œ ì—°êµ¬ ë¡œì§

### Dashboard (dashboard/)
- **ì™„ë£Œ**: React í”„ë¡ íŠ¸ì—”ë“œ + Firebase Hosting ë°°í¬
- **ì™„ë£Œ**: Cloud Functions ë°±ì—”ë“œ (Node.js 20, asia-northeast3)
- **ì™„ë£Œ**: Gemini 2.0 Flash AI ì—°ë™ (ì›Œí¬í”Œë¡œìš° ìë™ ì‹¤í–‰)
- **ì™„ë£Œ**: Firebase Authentication (Google OAuth)
- **ì™„ë£Œ**: 4ë‹¨ê³„ Phase ê¸°ë°˜ ì›Œí¬í”Œë¡œìš° ìë™ ì‹¤í–‰
- **ì™„ë£Œ**: HITL ìŠ¹ì¸/ê±°ì ˆ Web UI
- **ì™„ë£Œ**: íœ´ì§€í†µ ê¸°ëŠ¥ (30ì¼ í›„ Cloud Schedulerë¡œ ìë™ ì‚­ì œ)

## ì¤‘ìš” íŒŒì¼ (ìì£¼ ìˆ˜ì •)

### Core Engine
- `config/agents/*.yaml` - ì—ì´ì „íŠ¸ skills ì •ì˜
- `src/agents/research/*.ts` - ì—ì´ì „íŠ¸ ë¡œì§ êµ¬í˜„
- `src/orchestration/WorkflowEngine.ts` - ì›Œí¬í”Œë¡œìš° ì‹¤í–‰
- `src/index.ts` - ìƒˆ ì—ì´ì „íŠ¸ ë“±ë¡

### Dashboard
- `dashboard/src/services/firestoreService.ts` - Firestore CRUD + ì‹¤ì‹œê°„ êµ¬ë…
- `dashboard/src/pages/*.tsx` - í˜ì´ì§€ ì»´í¬ë„ŒíŠ¸
- `dashboard/src/types/index.ts` - TypeScript íƒ€ì… ì •ì˜
- `dashboard/functions/src/index.ts` - Cloud Functions (5ê°œ í•¨ìˆ˜)

## Dashboard ë°°í¬ ëª…ë ¹ì–´

```bash
cd dashboard

# í”„ë¡ íŠ¸ì—”ë“œë§Œ ë°°í¬
firebase deploy --only hosting

# Cloud Functionsë§Œ ë°°í¬
firebase deploy --only functions

# ì „ì²´ ë°°í¬
npm run deploy
```

## Cloud Functions ëª©ë¡

| í•¨ìˆ˜ëª… | íŠ¸ë¦¬ê±° | ì„¤ëª… |
|--------|--------|------|
| `onWorkflowCreated` | Firestore onCreate | ì›Œí¬í”Œë¡œìš° ìƒì„± ì‹œ Phase ê¸°ë°˜ ìë™ ì‹¤í–‰ |
| `processApproval` | HTTPS Callable | HITL ìŠ¹ì¸/ê±°ì ˆ ì²˜ë¦¬ |
| `restartWorkflow` | HTTPS Callable | ì›Œí¬í”Œë¡œìš° ì¬ì‹œì‘ |
| `cleanupTrash` | Cloud Scheduler (ë§¤ì¼ 03:00 KST) | íœ´ì§€í†µ ìë™ ì •ë¦¬ |
| `manualCleanupTrash` | HTTPS Callable | ìˆ˜ë™ íœ´ì§€í†µ ì •ë¦¬ |

## Dashboard Phase ê¸°ë°˜ ì›Œí¬í”Œë¡œìš°

| Phase | ì´ë¦„ | ì—ì´ì „íŠ¸ | ìŠ¹ì¸ í•„ìš” |
|-------|------|----------|----------|
| 1 | ì—°êµ¬ ê¸°íš | Idea Building, Literature Search | No |
| 2 | ë°©ë²•ë¡  ì„¤ê³„ | Method Selection, Experiment Design | **Yes** |
| 3 | ë¶„ì„ ë° ê²€ì¦ | Data Analysis, Result Validation | No |
| 4 | ë…¼ë¬¸ ì‘ì„± | Paper Writing, Peer Review, Formatting Review | **Yes** |

## íœ´ì§€í†µ (Soft Delete) ì‹œìŠ¤í…œ

- ì›Œí¬í”Œë¡œìš° ì‚­ì œ ì‹œ `deletedAt` í•„ë“œ ì„¤ì •
- `permanentDeleteAt` = ì‚­ì œì¼ + 30ì¼
- Cloud Schedulerê°€ ë§¤ì¼ 03:00 KSTì— ë§Œë£Œ í•­ëª© ìë™ ì‚­ì œ
- `subscribeToWorkflows()`ëŠ” `deletedAt` ìˆëŠ” í•­ëª© ìë™ í•„í„°ë§

## ì°¸ê³ 

- Google ADK íŒ¨í„´ ì¤€ìˆ˜ (outputKey, escalate, SequentialAgent ë“±)
- ìŠ¹ì¸ ê²Œì´íŠ¸ëŠ” `config.approvalGates` ë°°ì—´ë¡œ ì„¤ì •
- ì„ì‹œ ìƒíƒœëŠ” `StateKeys.temp('key')` ì‚¬ìš© (í˜„ì¬ í„´ë§Œ ìœ íš¨)
- DashboardëŠ” Firebase ê¸°ë°˜ (Hosting, Functions, Firestore, Auth)
