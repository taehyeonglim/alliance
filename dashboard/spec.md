# Alliance Dashboard - 스펙 문서

## 개요

Alliance 멀티 에이전트 연구 시스템을 위한 웹 기반 대시보드 UI입니다.
연구자가 워크플로우를 쉽게 실행하고, 진행 상황을 모니터링하며, HITL(Human-in-the-Loop) 승인을 처리할 수 있습니다.

## 기술 스택

- **프론트엔드**: React + Vite + TypeScript
- **스타일링**: Tailwind CSS
- **라우팅**: React Router DOM
- **상태 관리**: TanStack React Query
- **아이콘**: Lucide React
- **백엔드 통신**: REST API (추후 WebSocket for 실시간 업데이트)

## 프로젝트 구조

```
dashboard/
├── src/
│   ├── components/          # 재사용 컴포넌트
│   │   ├── layout/          # 레이아웃 관련
│   │   │   ├── Sidebar.tsx
│   │   │   ├── Header.tsx
│   │   │   └── Layout.tsx
│   │   ├── workflow/        # 워크플로우 관련
│   │   │   ├── WorkflowCard.tsx
│   │   │   ├── AgentNode.tsx
│   │   │   └── WorkflowVisualizer.tsx
│   │   ├── agents/          # 에이전트 관련
│   │   │   ├── AgentCard.tsx
│   │   │   └── AgentStatus.tsx
│   │   ├── hitl/            # HITL 관련
│   │   │   ├── ApprovalModal.tsx
│   │   │   └── ApprovalQueue.tsx
│   │   └── common/          # 공통 컴포넌트
│   │       ├── Button.tsx
│   │       ├── Card.tsx
│   │       ├── Modal.tsx
│   │       ├── Input.tsx
│   │       └── Badge.tsx
│   ├── pages/               # 페이지 컴포넌트
│   │   ├── Dashboard.tsx    # 메인 대시보드
│   │   ├── NewResearch.tsx  # 새 연구 시작
│   │   ├── Workflow.tsx     # 워크플로우 상세/모니터링
│   │   ├── Agents.tsx       # 에이전트 목록/상태
│   │   ├── Approvals.tsx    # HITL 승인 대기 목록
│   │   ├── History.tsx      # 실행 이력
│   │   └── Settings.tsx     # 설정
│   ├── hooks/               # 커스텀 훅
│   │   ├── useWorkflow.ts
│   │   ├── useAgents.ts
│   │   └── useApprovals.ts
│   ├── api/                 # API 클라이언트
│   │   ├── client.ts
│   │   ├── workflows.ts
│   │   ├── agents.ts
│   │   └── approvals.ts
│   ├── types/               # TypeScript 타입
│   │   └── index.ts
│   ├── utils/               # 유틸리티
│   │   └── index.ts
│   ├── App.tsx
│   ├── main.tsx
│   └── index.css
├── public/
├── index.html
├── package.json
├── tsconfig.json
├── vite.config.ts
├── tailwind.config.js
├── postcss.config.js
└── spec.md                  # 이 문서
```

## 페이지별 기능 명세

### 1. Dashboard (메인 대시보드)

**경로**: `/`

**기능**:
- 현재 진행 중인 워크플로우 요약 카드
- HITL 승인 대기 중인 항목 알림 배지
- 최근 완료된 연구 목록
- 빠른 시작 버튼 ("새 연구 시작")
- 시스템 상태 개요 (에이전트 상태)

**UI 요소**:
```
┌─────────────────────────────────────────────────────────────┐
│  Alliance Dashboard                          [🔔 2] [⚙️]   │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────────┐  ┌─────────────────┐                  │
│  │ 진행 중인 연구   │  │ 승인 대기       │                  │
│  │      3          │  │      2          │                  │
│  └─────────────────┘  └─────────────────┘                  │
│                                                             │
│  [+ 새 연구 시작]                                           │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 현재 진행 중                                         │   │
│  │ ┌─────────────────────────────────────────────────┐ │   │
│  │ │ 📊 암 바이오마커 연구                            │ │   │
│  │ │ ████████░░░░░░░ 60% - 데이터 분석 중            │ │   │
│  │ └─────────────────────────────────────────────────┘ │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 최근 완료된 연구                                     │   │
│  │ • AI 신약 개발 가능성 - 2024-01-15 ✅               │   │
│  │ • 기후변화 영향 분석 - 2024-01-14 ✅               │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 2. NewResearch (새 연구 시작)

**경로**: `/new`

**기능**:
- 연구 주제/아이디어 입력 폼
- 워크플로우 선택 (기본: default-research-workflow)
- 옵션 설정 (자동 승인 여부, 알림 설정 등)
- 연구 시작 버튼

**UI 요소**:
```
┌─────────────────────────────────────────────────────────────┐
│  새 연구 시작                                               │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  연구 주제 *                                                │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 예: CRISPR 기반 유전자 치료의 효율성 분석           │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  상세 설명 (선택)                                           │
│  ┌─────────────────────────────────────────────────────┐   │
│  │                                                     │   │
│  │                                                     │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  워크플로우 선택                                            │
│  ○ 기본 연구 워크플로우 (6단계)                            │
│  ○ 빠른 문헌 검토 (3단계)                                  │
│  ○ 커스텀...                                               │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ ⚙️ 고급 옵션                                        │   │
│  │ ☐ 실험 설계 자동 승인                               │   │
│  │ ☐ 논문 초안 자동 승인                               │   │
│  │ ☑ 이메일 알림 받기                                  │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│                              [취소]  [🚀 연구 시작]        │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 3. Workflow (워크플로우 상세/모니터링)

**경로**: `/workflow/:id`

**기능**:
- 워크플로우 시각화 (에이전트 흐름도)
- 각 에이전트 실행 상태 표시
- 현재 실행 중인 에이전트 하이라이트
- 에이전트별 출력 결과 확인
- HITL 승인 대기 시 인라인 승인 UI
- 실시간 로그 뷰어

**UI 요소**:
```
┌─────────────────────────────────────────────────────────────┐
│  📊 암 바이오마커 연구                      [일시정지] [중지] │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  워크플로우 진행 상황                                        │
│  ┌─────────────────────────────────────────────────────┐   │
│  │                                                     │   │
│  │  [✅ 아이디어] → [✅ 문헌검색] → [🔄 실험설계]      │   │
│  │        ↓                                            │   │
│  │  [⏳ 포맷팅] ← [⏳ 논문작성] ← [⏳ 데이터분석]      │   │
│  │                                                     │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 🔄 실험 설계 - 진행 중                               │   │
│  │                                                     │   │
│  │ 현재 상태: 실험 프로토콜 생성 중...                  │   │
│  │ 경과 시간: 2분 34초                                 │   │
│  │                                                     │   │
│  │ [출력 미리보기]                                     │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 📜 실행 로그                              [자동 스크롤] │   │
│  │ ─────────────────────────────────────────────────── │   │
│  │ 10:32:15 [idea-building] 완료: research_idea 저장   │   │
│  │ 10:32:16 [literature-search] 시작                   │   │
│  │ 10:35:42 [literature-search] 완료: 47개 논문 발견   │   │
│  │ 10:35:43 [experiment-design] 시작                   │   │
│  │ 10:37:21 [experiment-design] 프로토콜 생성 중...    │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 4. Agents (에이전트 목록)

**경로**: `/agents`

**기능**:
- 등록된 모든 에이전트 목록
- 에이전트별 상태 (idle, running, error)
- 에이전트 상세 정보 (skills, tools)
- 에이전트 설정 수정

**UI 요소**:
```
┌─────────────────────────────────────────────────────────────┐
│  에이전트 관리                                              │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌───────────────────────────┐ ┌───────────────────────────┐│
│  │ 💡 아이디어 빌딩          │ │ 📚 문헌 검색              ││
│  │ idea-building             │ │ literature-search         ││
│  │ ──────────────────────── │ │ ──────────────────────── ││
│  │ 상태: 🟢 대기 중          │ │ 상태: 🟢 대기 중          ││
│  │ 마지막 실행: 10분 전      │ │ 마지막 실행: 8분 전       ││
│  │ [상세보기]                │ │ [상세보기]                ││
│  └───────────────────────────┘ └───────────────────────────┘│
│                                                             │
│  ┌───────────────────────────┐ ┌───────────────────────────┐│
│  │ 🧪 실험 설계              │ │ 📊 데이터 분석            ││
│  │ experiment-design         │ │ data-analysis             ││
│  │ ──────────────────────── │ │ ──────────────────────── ││
│  │ 상태: 🔵 실행 중          │ │ 상태: 🟢 대기 중          ││
│  │ 현재 작업: 프로토콜 생성  │ │ 마지막 실행: 1시간 전     ││
│  │ [상세보기]                │ │ [상세보기]                ││
│  └───────────────────────────┘ └───────────────────────────┘│
│                                                             │
│  ┌───────────────────────────┐ ┌───────────────────────────┐│
│  │ ✍️ 논문 작성              │ │ 📋 포맷팅 검토            ││
│  │ paper-writing             │ │ formatting-review         ││
│  │ ──────────────────────── │ │ ──────────────────────── ││
│  │ 상태: 🟢 대기 중          │ │ 상태: 🟢 대기 중          ││
│  │ 승인 필요: ✅              │ │ 승인 필요: ✅              ││
│  │ [상세보기]                │ │ [상세보기]                ││
│  └───────────────────────────┘ └───────────────────────────┘│
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 5. Approvals (HITL 승인 대기)

**경로**: `/approvals`

**기능**:
- 승인 대기 중인 모든 항목 목록
- 승인/거절/수정 요청 액션
- 에이전트 출력 미리보기
- 피드백 입력

**UI 요소**:
```
┌─────────────────────────────────────────────────────────────┐
│  승인 대기 목록                                    [2 대기중] │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 🔴 긴급 - 실험 설계 승인 필요                        │   │
│  │ ─────────────────────────────────────────────────── │   │
│  │ 연구: 암 바이오마커 연구                             │   │
│  │ 에이전트: experiment-design                          │   │
│  │ 대기 시간: 5분                                       │   │
│  │                                                     │   │
│  │ 출력 미리보기:                                       │   │
│  │ ┌─────────────────────────────────────────────────┐ │   │
│  │ │ ## 실험 프로토콜                                │ │   │
│  │ │ 1. 샘플 수집: 100명의 환자 혈액 샘플...        │ │   │
│  │ │ 2. 바이오마커 분석: ELISA 방법 사용...         │ │   │
│  │ │ [더 보기...]                                   │ │   │
│  │ └─────────────────────────────────────────────────┘ │   │
│  │                                                     │   │
│  │ 피드백 (선택):                                       │   │
│  │ ┌─────────────────────────────────────────────────┐ │   │
│  │ │                                                 │ │   │
│  │ └─────────────────────────────────────────────────┘ │   │
│  │                                                     │   │
│  │            [거절] [수정 요청] [✅ 승인]             │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 🟡 논문 초안 승인 필요                               │   │
│  │ ─────────────────────────────────────────────────── │   │
│  │ 연구: AI 신약 개발 가능성                            │   │
│  │ 에이전트: paper-writing                              │   │
│  │ 대기 시간: 32분                                      │   │
│  │ [펼치기...]                                         │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 6. History (실행 이력)

**경로**: `/history`

**기능**:
- 과거 워크플로우 실행 이력
- 필터링 (날짜, 상태, 워크플로우 타입)
- 결과 다운로드/내보내기
- 실행 재시작

### 7. Settings (설정)

**경로**: `/settings`

**기능**:
- API 엔드포인트 설정
- LLM 설정 (모델, 온도 등)
- 알림 설정
- 테마 (다크/라이트)
- 언어 (한국어/영어)

## 공통 컴포넌트

### Layout
- **Sidebar**: 네비게이션 메뉴 (항상 표시)
- **Header**: 페이지 제목, 알림, 설정 버튼
- **Main Content**: 각 페이지 콘텐츠

### 상태 표시
- 🟢 대기 중 (idle)
- 🔵 실행 중 (running)
- 🟡 승인 대기 (pending_approval)
- ✅ 완료 (completed)
- 🔴 오류 (error)

## API 엔드포인트 (백엔드 연동)

### Workflows
```
GET    /api/workflows              # 워크플로우 목록
POST   /api/workflows              # 새 워크플로우 시작
GET    /api/workflows/:id          # 워크플로우 상세
DELETE /api/workflows/:id          # 워크플로우 중지
GET    /api/workflows/:id/logs     # 실행 로그
```

### Agents
```
GET    /api/agents                 # 에이전트 목록
GET    /api/agents/:id             # 에이전트 상세
GET    /api/agents/:id/status      # 에이전트 상태
```

### Approvals (HITL)
```
GET    /api/approvals              # 승인 대기 목록
POST   /api/approvals/:id/approve  # 승인
POST   /api/approvals/:id/reject   # 거절
POST   /api/approvals/:id/modify   # 수정 요청
```

### Sessions
```
GET    /api/sessions               # 세션 목록
GET    /api/sessions/:id           # 세션 상태
GET    /api/sessions/:id/state     # 세션 상태값
```

## 실시간 업데이트

WebSocket을 통해 다음 이벤트를 수신:
- `workflow:status` - 워크플로우 상태 변경
- `agent:status` - 에이전트 상태 변경
- `approval:new` - 새 승인 요청
- `log:new` - 새 로그 메시지

## 설치 및 실행

```bash
# 의존성 설치
cd dashboard
npm install

# 개발 서버 실행
npm run dev

# 프로덕션 빌드
npm run build
```

## 환경 변수

```env
VITE_API_URL=http://localhost:3001/api
VITE_WS_URL=ws://localhost:3001
```

## 구현 우선순위

1. **Phase 1**: 기본 레이아웃, 라우팅, 대시보드 페이지
2. **Phase 2**: NewResearch, Workflow 모니터링 페이지
3. **Phase 3**: Approvals (HITL) 페이지
4. **Phase 4**: Agents, History, Settings 페이지
5. **Phase 5**: WebSocket 실시간 업데이트
6. **Phase 6**: 백엔드 API 서버 구현

## 디자인 가이드라인

- **색상**:
  - Primary: Blue (#3B82F6)
  - Success: Green (#10B981)
  - Warning: Yellow (#F59E0B)
  - Error: Red (#EF4444)
  - Background: Gray (#F3F4F6) / Dark (#1F2937)

- **폰트**: Inter (영문), Pretendard (한글)

- **반응형**:
  - Mobile: < 768px
  - Tablet: 768px - 1024px
  - Desktop: > 1024px
